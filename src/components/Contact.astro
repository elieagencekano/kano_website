---
const hrefWithBase = (h: string) => {
  const base = import.meta.env.BASE_URL;
  if (h.startsWith("#")) return `${base}${h}`;
  if (h.startsWith("/")) return base + h.slice(1);
  return h;
};
---

<section class="contact" aria-label="Contact">
  <div class="container">
    <header class="header-contact">
      <h1>Échangeons sur votre projet</h1>
      <p class="subtitle">Agence digitale à Angers, on vous répond sous 24h.</p>
    </header>

    <div class="contact-grid">
      <div class="form-section glass">
        <form id="contact-form" action="https://formcarry.com/s/XUrbejqYyQR" method="POST">
          <div class="form-group">
            <label for="name">Nom complet</label>
            <input type="text" id="name" name="name" required placeholder="Votre nom" />
          </div>
          
          <div class="form-group">
            <label for="email">Email</label>
            <input type="email" id="email" name="email" required placeholder="votre@email.fr" />
          </div>
          
          <div class="form-group">
            <label for="phone">Téléphone</label>
            <input type="tel" id="phone" name="phone" required placeholder="06 00 00 00 00" />
          </div>
          
          <div class="form-group">
            <label for="message">Message <span class="optional">(facultatif)</span></label>
            <textarea id="message" name="message" rows="4" placeholder="Décrivez brièvement votre projet..."></textarea>
          </div>
          
          <button type="submit" class="btn-submit">
            <span>Envoyer</span>
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"/>
            </svg>
          </button>
        </form>
        
        <div id="form-success" class="form-success">
          <div class="success-icon">
            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
              <polyline points="22 4 12 14.01 9 11.01"/>
            </svg>
          </div>
          <h3>Message envoyé !</h3>
          <p>On vous recontacte très vite.</p>
        </div>
      </div>

      <div class="side-section">
        <div class="calendly-section glass">
          <div class="calendly-icon">
            <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
              <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
              <line x1="16" y1="2" x2="16" y2="6"/>
              <line x1="8" y1="2" x2="8" y2="6"/>
              <line x1="3" y1="10" x2="21" y2="10"/>
              <path d="m9 16 2 2 4-4"/>
            </svg>
          </div>
          <h2>Vous savez déjà ce que vous voulez ?</h2>
          <p>Réservez directement un créneau. Si c'est dans plus de 4 jours, on vous prépare une démo personnalisée. Sinon, on échange simplement sur votre projet.</p>
          <a href="https://calendly.com/consultingkano/30min" target="_blank" rel="noopener noreferrer" class="btn-calendly">
            <span>Réserver un appel</span>
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M5 12h14M12 5l7 7-7 7"/>
            </svg>
          </a>
        </div>

        <div class="contact-info glass">
          <h2>Nos coordonnées</h2>
          <ul class="info-list">
            <li>
              <a href="tel:+33672390896" class="info-item">
                <div class="info-icon">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/>
                  </svg>
                </div>
                <span>06 72 39 08 96</span>
              </a>
            </li>
            <li>
              <a href="mailto:contact@consultingkano.fr" class="info-item">
                <div class="info-icon">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="2" y="4" width="20" height="16" rx="2"/>
                    <path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/>
                  </svg>
                </div>
                <span>contact@consultingkano.fr</span>
              </a>
            </li>
            <li>
              <div class="info-item">
                <div class="info-icon">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/>
                    <circle cx="12" cy="10" r="3"/>
                  </svg>
                </div>
                <span>Angers, France</span>
              </div>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</section>

<style>
.contact{position:relative;min-height:100svh;padding:120px 0 80px;overflow:hidden}
.container{max-width:1200px;margin:0 auto;padding:0 32px}
.header-contact{text-align:center;margin-bottom:60px;animation:fadeSlideUp 800ms cubic-bezier(.34,.46,.35,1)}
@keyframes fadeSlideUp{from{opacity:0;transform:translateY(40px) scale(.95)}to{opacity:1;transform:translateY(0) scale(1)}}
.header-contact h1{font-size:clamp(2.2rem,4.4vw,3.6rem);font-family:Montserrat,sans-serif;font-weight:900;margin:0 0 16px;background:linear-gradient(135deg,#fff 0%,rgba(255,255,255,.9) 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;line-height:1.2;padding-bottom:4px}
.subtitle{font-size:1.15rem;color:var(--kano-light);opacity:.85;margin:0}
.contact-grid{display:grid;grid-template-columns:1fr 1fr;gap:32px;align-items:stretch}
.glass{background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.1);backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);border-radius:20px}
.form-section{padding:40px;animation:slideInLeft 800ms cubic-bezier(.34,.46,.35,1) 150ms backwards;position:relative}
@keyframes slideInLeft{from{opacity:0;transform:translateX(-50px) scale(.96)}to{opacity:1;transform:translateX(0) scale(1)}}
.form-group{margin-bottom:24px}
.form-group label{display:block;font-size:.9rem;font-weight:600;color:#fff;margin-bottom:8px}
.optional{font-weight:400;color:var(--kano-light);opacity:.6}
.form-group input,.form-group textarea{width:100%;padding:14px 18px;border-radius:12px;border:1px solid rgba(255,255,255,.12);background:rgba(255,255,255,.04);color:#fff;font-size:1rem;font-family:Poppins,sans-serif;transition:all .3s ease;box-sizing:border-box}
.form-group input::placeholder,.form-group textarea::placeholder{color:var(--kano-light);opacity:.5}
.form-group input:focus,.form-group textarea:focus{outline:none;border-color:rgba(212,175,55,.5);background:rgba(255,255,255,.06);box-shadow:0 0 0 3px rgba(212,175,55,.1)}
.form-group textarea{resize:vertical;min-height:100px}
.btn-submit{display:inline-flex;align-items:center;gap:10px;padding:16px 32px;border-radius:999px;background:var(--kano-gold);color:var(--kano-ink);font-weight:700;font-size:1rem;border:none;cursor:pointer;transition:all .3s cubic-bezier(.4,0,.2,1);box-shadow:0 8px 26px rgba(212,175,55,.25);width:100%;justify-content:center}
.btn-submit:hover{transform:translateY(-3px);box-shadow:0 12px 32px rgba(212,175,55,.4)}
.btn-submit:active{transform:translateY(-1px)}
.btn-submit svg{transition:transform .3s cubic-bezier(.34,.46,.35,1);transform:rotate(45deg)}
.btn-submit:hover svg{transform:rotate(25deg) scale(1.15)}
.form-success{display:none;text-align:center;padding:40px 20px;animation:scaleIn 500ms ease-out}
@keyframes scaleIn{from{opacity:0;transform:scale(.9)}to{opacity:1;transform:scale(1)}}
.form-success.show{display:block}
.form-section form.hidden{display:none}
.success-icon{width:64px;height:64px;border-radius:50%;background:linear-gradient(135deg,rgba(212,175,55,.2),rgba(212,175,55,.08));border:1px solid rgba(212,175,55,.3);display:flex;align-items:center;justify-content:center;margin:0 auto 20px;color:var(--kano-gold)}
.form-success h3{font-size:1.4rem;font-weight:800;color:#fff;margin:0 0 8px}
.form-success p{color:var(--kano-light);opacity:.8;margin:0}
.side-section{display:flex;flex-direction:column;gap:24px}
.calendly-section{animation:slideInRight 800ms cubic-bezier(.34,.46,.35,1) 250ms backwards}
.contact-info{animation:slideInRight 800ms cubic-bezier(.34,.46,.35,1) 400ms backwards}
@keyframes slideInRight{from{opacity:0;transform:translateX(50px) scale(.96)}to{opacity:1;transform:translateX(0) scale(1)}}
.contact-info{padding:32px}
.contact-info h2{font-size:1.2rem;font-weight:800;color:#fff;margin:0 0 20px;font-family:Montserrat,sans-serif}
.info-list{list-style:none;padding:0;margin:0;display:flex;flex-direction:column;gap:16px}
.info-item{display:flex;align-items:center;gap:14px;color:var(--kano-light);text-decoration:none;transition:all .3s ease;padding:8px 0}
a.info-item:hover{color:var(--kano-gold)}
.info-icon{width:44px;height:44px;border-radius:12px;background:linear-gradient(135deg,rgba(212,175,55,.12),rgba(212,175,55,.04));border:1px solid rgba(212,175,55,.2);display:flex;align-items:center;justify-content:center;color:var(--kano-gold);flex-shrink:0;transition:all .3s cubic-bezier(.34,.46,.35,1)}
.info-icon svg{transition:transform .3s cubic-bezier(.34,.46,.35,1)}
.info-item:hover .info-icon{background:linear-gradient(135deg,rgba(212,175,55,.2),rgba(212,175,55,.1));border-color:rgba(212,175,55,.4);box-shadow:0 8px 24px rgba(212,175,55,.2)}
.info-item:hover .info-icon svg{transform:scale(1.15) rotate(8deg)}
.info-item span{font-size:.95rem}
.calendly-section{padding:32px;text-align:center}
.calendly-icon{width:56px;height:56px;border-radius:14px;background:linear-gradient(135deg,rgba(212,175,55,.2),rgba(212,175,55,.08));border:1px solid rgba(212,175,55,.3);display:flex;align-items:center;justify-content:center;margin:0 auto 20px;color:var(--kano-gold);transition:all .4s cubic-bezier(.34,.46,.35,1)}
.calendly-icon svg{transition:transform .4s cubic-bezier(.34,.46,.35,1)}
.calendly-section:hover .calendly-icon{box-shadow:0 8px 24px rgba(212,175,55,.2)}
.calendly-section:hover .calendly-icon svg{transform:scale(1.15) rotate(8deg)}
.calendly-section h2{font-size:1.15rem;font-weight:800;color:#fff;margin:0 0 12px;font-family:Montserrat,sans-serif}
.calendly-section p{font-size:.9rem;color:var(--kano-light);opacity:.8;line-height:1.6;margin:0 0 24px}
.btn-calendly{display:inline-flex;align-items:center;gap:8px;padding:14px 28px;border-radius:999px;background:transparent;color:#fff;font-weight:700;font-size:.95rem;text-decoration:none;border:1px solid rgba(255,255,255,.2);transition:all .3s cubic-bezier(.4,0,.2,1)}
.btn-calendly svg{transition:transform .3s cubic-bezier(.34,.46,.35,1)}
.btn-calendly:hover{border-color:var(--kano-gold);color:var(--kano-gold);transform:translateY(-2px);box-shadow:0 8px 24px rgba(212,175,55,.15)}
.btn-calendly:hover svg{transform:translateX(4px)}
@media (max-width:1024px){.contact-grid{grid-template-columns:1fr;gap:24px}.form-section{order:1}.side-section{order:2}}
@media (max-width:768px){.contact{padding:100px 0 60px}.container{padding:0 20px}.header-contact{margin-bottom:40px}.form-section{padding:28px}.contact-info{padding:24px}.calendly-section{padding:24px}}
@media (max-width:480px){.contact{padding:84px 0 42px}.header-contact h1{font-size:1.8rem}.form-section{padding:24px 20px}.form-group{margin-bottom:20px}.btn-submit{padding:14px 24px}}
</style>

<script>
const form = document.getElementById('contact-form') as HTMLFormElement;
const successMessage = document.getElementById('form-success');

form.addEventListener('submit', async (e) => {
  e.preventDefault();
  
  const submitBtn = form.querySelector('.btn-submit') as HTMLButtonElement;
  const originalText = submitBtn.innerHTML;
  submitBtn.innerHTML = '<span>Envoi en cours...</span>';
  submitBtn.disabled = true;
  
  try {
    const formData = new FormData(form);
    const response = await fetch(form.action, {
      method: 'POST',
      body: formData,
      headers: {
        'Accept': 'application/json'
      }
    });
    
    if (response.ok) {
      form.classList.add('hidden');
      successMessage.classList.add('show');
    } else {
      throw new Error('Erreur lors de l\'envoi');
    }
  } catch (error) {
    submitBtn.innerHTML = originalText;
    submitBtn.disabled = false;
    alert('Une erreur est survenue. Veuillez réessayer ou nous contacter directement.');
  }
});
</script>