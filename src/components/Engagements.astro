---
const engagements = [
  {
    icon: `<path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>`,
    text: "Prix clairs, expliqués"
  },
  {
    icon: `<path d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"/><path d="m9 12 2 2 4-4"/>`,
    text: "Aucun engagement forcé"
  },
  {
    icon: `<path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/>`,
    text: "Un site qui vous appartient"
  },
  {
    icon: `<circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/>`,
    text: "Délais respectés"
  },
  {
    icon: `<path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75"/>`,
    text: "Collaboration simple et directe"
  },
  {
    icon: `<path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>`,
    text: "Accompagnement humain"
  },
  {
    icon: `<line x1="18" y1="20" x2="18" y2="10"/><line x1="12" y1="20" x2="12" y2="4"/><line x1="6" y1="20" x2="6" y2="14"/>`,
    text: "Recherche réelle de performance"
  }
];

const hrefWithBase = (h: string) => {
  const base = import.meta.env.BASE_URL;
  if (h.startsWith("#")) return `${base}${h}`;
  if (h.startsWith("/")) return base + h.slice(1);
  return h;
};
---

<section class="engagements" aria-label="Nos engagements">
  <div class="container">
    <header class="header-engagements">
      <h2>Ce qui nous définit</h2>
      <p>On n'a pas cherché à être la plus grosse agence. On veut juste être une agence qui fait bien son travail.</p>
    </header>

    <div class="engagements-grid">
      {engagements.map((item, index) => (
        <div class="engagement-item" style={`--delay: ${index * 80}ms`}>
          <div class="engagement-icon">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
              <Fragment set:html={item.icon} />
            </svg>
          </div>
          <span class="engagement-text">{item.text}</span>
        </div>
      ))}
    </div>

    <div class="engagements-footer">
      <p>Pas d'artifice, pas de promesse trop belle. Juste une méthode de travail transparente et efficace.</p>
      <p class="conclusion">Si cette façon d'aborder les projets vous parle, alors on pourra construire quelque chose de solide ensemble.</p>
      <a href={hrefWithBase("/contact")} class="btn-cta">
        <span>Parlons de votre projet</span>
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M5 12h14M12 5l7 7-7 7"/>
        </svg>
      </a>
    </div>
  </div>
</section>

<style>
.engagements{position:relative;padding:100px 0;overflow:hidden}
.container{max-width:900px;margin:0 auto;padding:0 32px}
.header-engagements{text-align:center;margin-bottom:60px;opacity:0;transform:translateY(40px)}
.header-engagements.visible{animation:fadeUp 800ms cubic-bezier(.16,1,.3,1) forwards}
@keyframes fadeUp{from{opacity:0;transform:translateY(40px)}to{opacity:1;transform:translateY(0)}}
.header-engagements h2{font-size:clamp(1.8rem,3.5vw,2.8rem);font-family:Montserrat,sans-serif;font-weight:900;margin:0 0 16px;background:linear-gradient(135deg,#fff 0%,rgba(255,255,255,.9) 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;line-height:1.2;padding-bottom:4px}
.header-engagements p{font-size:1.1rem;color:var(--kano-light);opacity:.8;line-height:1.6;margin:0;max-width:600px;margin-left:auto;margin-right:auto}
.engagements-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:16px;margin-bottom:48px}
.engagement-item{display:flex;align-items:center;gap:16px;padding:20px 24px;border-radius:12px;background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.08);opacity:0;transform:translateX(-20px);transition:all .3s cubic-bezier(.34,.46,.35,1)}
.engagement-item.visible{animation:slideIn 600ms cubic-bezier(.16,1,.3,1) var(--delay) forwards}
@keyframes slideIn{from{opacity:0;transform:translateX(-20px)}to{opacity:1;transform:translateX(0)}}
.engagement-item:hover{background:rgba(255,255,255,.06);border-color:rgba(212,175,55,.2);transform:translateX(4px)}
.engagement-icon{width:40px;height:40px;border-radius:10px;background:linear-gradient(135deg,rgba(212,175,55,.12),rgba(212,175,55,.04));border:1px solid rgba(212,175,55,.2);display:flex;align-items:center;justify-content:center;color:var(--kano-gold);flex-shrink:0;transition:all .3s cubic-bezier(.34,.46,.35,1)}
.engagement-icon svg{transition:transform .3s cubic-bezier(.34,.46,.35,1)}
.engagement-item:hover .engagement-icon{background:linear-gradient(135deg,rgba(212,175,55,.2),rgba(212,175,55,.1));border-color:rgba(212,175,55,.4);box-shadow:0 8px 24px rgba(212,175,55,.2)}
.engagement-item:hover .engagement-icon svg{transform:scale(1.15) rotate(8deg)}
.engagement-text{font-size:1rem;color:#fff;font-weight:600}
.engagements-footer{text-align:center;opacity:0;transform:translateY(30px)}
.engagements-footer.visible{animation:fadeUp 800ms cubic-bezier(.16,1,.3,1) forwards}
.engagements-footer p{font-size:1.05rem;color:var(--kano-light);opacity:.7;line-height:1.6;margin:0 0 16px;font-style:italic}
.engagements-footer .conclusion{font-size:1.15rem;color:#fff;opacity:.9;font-style:normal;font-weight:500;margin:0 0 32px}
.btn-cta{display:inline-flex;align-items:center;gap:10px;padding:16px 32px;border-radius:999px;background:var(--kano-gold);color:var(--kano-ink);font-weight:700;font-size:1rem;text-decoration:none;transition:all .3s cubic-bezier(.4,0,.2,1);box-shadow:0 8px 26px rgba(212,175,55,.25)}
.btn-cta:hover{transform:translateY(-3px);box-shadow:0 12px 32px rgba(212,175,55,.4)}
.btn-cta svg{transition:transform .3s cubic-bezier(.34,.46,.35,1)}
.btn-cta:hover svg{transform:scale(1.15) rotate(-8deg)}
@media (max-width:768px){.engagements{padding:80px 0}.container{padding:0 20px}.header-engagements{margin-bottom:48px}.engagements-grid{grid-template-columns:1fr;gap:12px}}
@media (max-width:480px){.engagements{padding:60px 0}.engagement-item{padding:16px 18px}.engagement-icon{width:36px;height:36px}.engagement-text{font-size:.95rem}}
</style>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const elements = document.querySelectorAll('.header-engagements, .engagement-item, .engagements-footer');
  
  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting && entry.boundingClientRect.top > 0) {
        entry.target.classList.add('visible');
        observer.unobserve(entry.target);
      }
    });
  }, {
    threshold: 0.3,
    rootMargin: '0px 0px -100px 0px'
  });

  setTimeout(() => {
    elements.forEach(el => {
      const rect = el.getBoundingClientRect();
      if (rect.top > window.innerHeight) {
        observer.observe(el);
      } else if (rect.top > 100) {
        observer.observe(el);
      } else {
        el.classList.add('visible');
      }
    });
  }, 100);
});
</script>